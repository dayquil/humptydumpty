This collection of scripts analyzes the logs generated by iptables.
I decided to break them up into 4 separate scripts as the output can be
quite long.

Iptables does not log by default. We have to tell iptables to log
everything. To do this we need to enter:

(as root or sudo)

iptables -I INPUT 1 -j LOG --log-prefix "Incoming: "
iptables -I OUTPUT 1 -j LOG --log-prefix "Outgoing: "

This will insert each rule in the 1st position of each chain.

*** Its important to put the "Incoming: " tag in there because that
will be our greppable identifier. If it is not there we will not get any
data back.

By default the above commands in a debian based environment will log to:
(this includes ubuntu, debian, red-het, centos and more)

/var/log/kern.log
/var/log/syslog

there maybe others.

Just to make sure your are actually logging traffic you can get a quick 
glimpse with the command:

dmesg

There are 4 scripts, I would rank them in-order of importance:

(1)tcp-in.sh
(2)tcp-out.sh
(3)udp-in.sh
(4)udp-out.sh

Let the logs run for a while. When you have a chance run one of the scripts.
To run the script you must first make it executable. Do this by:

chmod +x tcp-in.sh

To execute the script you must feed it a log file to comb through:

./tcp-in.sh /var/log/syslog


The output is broken up into 4 sections: Port Frequency, IP Frequency,
IP & Port Frequency, and ICMP (Ping) IP Addresses.

Explanation:

If you run "./tcp-in.sh" you will be combing through the log files looking
for all incoming tcp connections.

The output will be written to a file, in the same directory from which you 
ran the script, as well as on the screen it will be piped through "less".

The first grouping is port frequency. It shows the port number on the 
right and the count of how many times it was hit on the left.

The second group is IP Frequency. This shows the IP addresses on the right
of all the host trying to connect to us and on the left how many packets
we've received from each host.

The third group is IP & Port frequency. This data will be similar to the 
above groups but will be different and in some occasions can be drastically
different. This show which IP addresses hit which ports and how many times.

The fourth group is ICMP. I put this at the end of every script in the 
set. This shows us how many times we have received a incoming ICMP packet
and from which IP address.





